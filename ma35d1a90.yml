header:
  version: 11

build_system: oe

distro: nvt-ma35d1-directfb

#defaults:
#  repos:
#    patches:
#      repo: ma35d1-yocto


defaults:
  repos:
    patches:
      repo: kas-ma35d1

repos:
  #sources/meta-arm:
  #  url: git://git.yoctoproject.org/meta-arm
  #  refspec: dunfell
  #  layers:
  #    meta-arm:
  #    meta-arm-bsp:
  #    meta-arm-toolchain:

  sources/meta-virtualization:
    url: git://git.yoctoproject.org/meta-virtualization
    refspec: dunfell

  sources/meta-qt5:
    url: https://github.com/meta-qt5/meta-qt5
    refspec: dunfell

  sources/poky:
    url: git://git.yoctoproject.org/poky
    refspec: dunfell
    layers:
      meta:
      meta-poky:
#      meta-yocto-bsp:

  sources/meta-openembedded:
    url: https://github.com/openembedded/meta-openembedded
    refspec: dunfell
    layers:
      meta-oe:
      meta-multimedia:
      meta-python:
      meta-networking:
      meta-filesystems:
      meta-gnome:

  sources/ma35d1-yocto:
    url: https://github.com/OpenNuvoton/MA35D1_Yocto-v3.1.3
    refspec: master
    layers:
      meta-ma35d1:
    patches:
      01-upgrade-pyinstaller:
        path: patches/0001-upgrade-pyinstaller-version-to-v5.6.2.patch
      02-update-depands-nuwriter:
        path: patches/0002-update-DEPANDS-of-pyinstaller.patch
      03-update-openssl-version:
        path: patches/0003-update-to-openssl_1.1.1q.bbappend.patch
      04-replace-openssl-to-native:
        path: patches/0004-use-openssl-native-to-replace-host.patch
      05-fixed-m4project-link-failed:
        path: patches/0005-to-avoid-null-linkscript.patch
      06-fixed-genimg.patch:
        path: patches/0006-patch-genimg.patch
      07-fixed-nuwrite-rdepends:
        path: patches/0007-fixed-nuwrite-RDEPENDS-issues.patch
      08-add-debug-img-sdcard:
        path: patches/0008-add-debug-for-image-sdcard.patch

  kas-ma35d1:

local_conf_header:
  base: |
    CONF_VERSION = "1"
    PACKAGE_CLASSES = "package_ipk"
    LICENSE_FLAGS_ACCEPTED += "armcompiler"
    BB_NUMBER_THREADS ?= "8"
    PARALLEL_MAKE ?= "-j8"
  misc: |
    # BB_SIGNATURE_HANDLER = "OEEquivHash"
    # BB_HASHSERVE = "auto"
    # BB_HASHSERVE_UPSTREAM = "hashserv.yocto.io:8687"
    # SSTATE_MIRRORS ?= "file://.* https://sstate.yoctoproject.org/all/PATH;downloadfilename=PATH"
  root_password: |
    USERS += "root"
  machine_feature: |
    MACHINE_FEATURES_append = " optee "
# image_feature: |
#   DISTRO_FEATURES:append = ""
  debug_feature: |
    EXTRA_IMAGE_FEATURES = " debug-tweaks "
  image_install: |
    CORE_IMAGE_EXTRA_INSTALL += "kernel-modules "
    CORE_IMAGE_EXTRA_INSTALL += "ethtool "

machine: numaker-iot-ma35d16f90

target:
  - core-image-minimal
